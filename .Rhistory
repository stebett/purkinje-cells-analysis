library(STAR)
sim.agg <- function(file, n=1) {
res = read_rdata(file)
sims = tryCatch(sim(res, n), error=function(e) e)
list(fake=sims, index1=res$index1, index2=res$index2, group=res$group, reference=res$reference, landmark=res$landmark)
}
sim <- function(res, n) {
lfun = lapply(res$rnfun['r.timeSinceLastSpike'], mkSelf)
trials = lapply(split(res$data, res$data$trial), function(x) x[, names(res$gss$mf)])
fake = mapply(function(x) replicate(n, as.double(thinProcess(object=res$gss,
 m2uFctList=lfun,
 trueData=x,
 formerSpikes=-600))), 
  trials, SIMPLIFY=FALSE)
}
read_rdata <- function(file) {
r_data <- load(file)
x <- get(r_data)
return(x)
}
inpath = "data/analyses/spline/batch-8/best-neigh/out/data/
"
infiles <- list.files(path=inpath, pattern=".R", full.names=T, all.files=T)
file = infiles[8]
res = read_rdata(file)
infiles[8]
infiles[[8]]
infiles
inpath
inpath = "data/analyses/spline/batch-8/best-neigh/out/data/"
infiles <- list.files(path=inpath, pattern=".R", full.names=T, all.files=T)
infiles <- list.files(path=inpath, pattern=".R", full.names=T, all.files=T)
infiles
file = infiles[8]
file
res = read_rdata(file)
object=res$gss
trials = lapply(split(res$data, res$data$trial), function(x) x[, names(res$gss$mf)])
x = trials[1]
x
trueData = x
intensityMax <- maxIntensity(object, trueData, ...)
maxIntensity
intensityMax <- maxIntensity(object, trueData)
intensityMax <- maxIntensity(object, trueData, ...)
if (missing(intensityMax)) {
intensityMax <- maxIntensity(object, trueData, ...)
}
traceback()
intensityMax <- maxIntensity(object, trueData, ...)
traceback()
intensityMax <- maxIntensity(object, trueData)
traceback()
