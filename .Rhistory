library(gss)
source("/home/ginko/ens/data/analyses/spline/cluster-inputs-2/r.config/1-all-best.R")
data = load(uniformpath)
uniformpath
source("/home/ginko/ens/data/analyses/spline/cluster-inputs-2/r.config/11-all-best.R")
reference
group
data = load(uniformpath)
data$data
names(data)
data
data = load(uniformpath, "uniformized_df")
data = load(uniformpath)
uniformized_df
names(uniformized_df)
uniformized_df$
uniformized_df$"'
uniformized_df$""
library(STAR)
infiles <- dir(pattern='~/ens/data/analyses/spline/cluster-inputs-2/prova/R$')
infiles <- list.files(path="~/ens/data/analyses/spline/cluster-inputs-2/prova/", pattern=".R", full.names=T, all.files=T)
uniformize <- function(file){
source(file)
input = read.csv(csvpath)
rnparm=c('timeSinceLastSpike','previousIsi')
if (group != "all") {
rnparm <- c(rnparm, 'nearest')
}
rnparmName = paste('r',rnparm,sep='.')
rnfun=lapply(rnparm,function(x) mkM2U(input,x))
names(rnfun)=rnparmName
inv.rnfun=lapply(rnfun, function(x) attributes(x)$qFct)
res=mapply(function(c,f) f(input[[c]]), rnparm,rnfun)
colnames(res)=rnparmName
data=cbind(input,res) 
uniformized_df = list(inv.rnfun=inv.rnfun, rnfun=rnfun, data=data)
save(file=uniformpath, uniformized_df)
}
uniformize.ignore.errors <- function(file){
return(tryCatch(uniformize(file), error=function(e) file.remove(file)))
}
lapply(infiles , uniformize.ignore.errors)
uniformize.ignore.errors <- function(file){
return(tryCatch(uniformize(file), error=file.remove(file)))
}
infiles <- list.files(path="~/ens/data/analyses/spline/cluster-inputs-2/prova/", pattern=".R", full.names=T, all.files=T)
uniformize.ignore.errors <- function(file){
return(tryCatch(uniformize(file), error=file.remove(file)))
}
lapply(infiles , uniformize.ignore.errors)
return(tryCatch(uniformize(file), error=function(e) file.remove(file)))
uniformize.ignore.errors <- function(file){
return(tryCatch(uniformize(file), error=function(e) file.remove(file)))
}
lapply(infiles , uniformize.ignore.errors)
source("/home/ginko/ens/data/analyses/spline/cluster-inputs-2/r.config/11-all-best.R")
load(uniformpath)
uniform_df$data
uniformized_df$data
uniformized_df
names(uniformized_df)
source("/home/ginko/ens/data/analyses/spline/cluster-inputs-2/prova/c(49,47)-dist-best.R")
load(uniformpath)
names(uniformized_df)
uniformized_df$data
time = "time"
if (reference == "multi") {
time = "timetoevt"
}
indep = c("r.timeSinceLastSpike", time)
if (group != "all") {
indep <- c(indep, 'r.nearest')
}
dep = "event"
formula = as.formula(paste("event ~",  paste(indep, collapse= "+")))
gss = gssanova(formula, data=uniformized_df$data, family="binomial", alpha=1)
result = list(index=index, group=group, reference=reference, inv.rnfun=uniformized_df$inv.rnfun, rnfun=uniformized_df$rnfun, data=uniformized_df$data, gss=gss)
index
uniformpath
split(uniformpath)
split(uniformpath, f="/")
strsplit(uniformpath, f="/")
strsplit(uniformpath, split="/")
strsplit(uniformpath, split="/")[10]
strsplit(uniformpath, split="/")[9]
strsplit(uniformpath, split="/")[[10]]
strsplit(uniformpath, split="/")[[9]]
strsplit(uniformpath, split="/")
strsplit(uniformpath, split="[/\\.]")
typeof(strsplit(uniformpath, split="[/\\.]"))
strsplit(uniformpath, split="[/\\.]")
strsplit(uniformpath, split="[/\\.]")
filename = strsplit(uniformpath, split="[/\\.]")
filename[9]
filename[[9]]
filename[[1]]
filename[[1]][[10]]
filename = sapply(strsplit(uniformpath, split="[/]"), tail, 1)
filename
path = paste("~", filename, sep="/")
save(file=filename, result)
save(file=path, result)
load(path)
res <- load(path)
res
result
names(result)
result$inv.rnfun
infiles <- list.files(path="~/ens/data/analyses/spline/cluster-inputs-2/r.config/", pattern=".R", full.names=T, all.files=T)
lapply(infiles , uniformize.ignore.errors)
